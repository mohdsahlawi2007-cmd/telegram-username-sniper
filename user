import telebot
import random
import string
import time
import os

TOKEN = os.getenv('BOT_TOKEN')
CHAT_ID = os.getenv('CHAT_ID')

bot = telebot.TeleBot(TOKEN)

def generate_username(length=5):
    chars = string.ascii_lowercase + string.digits + '_'
    while True:
        username = ''.join(random.choice(chars) for _ in range(length))
        if not (username.startswith('_') or username.endswith('_') or username.startswith('0')):
            return '@' + username

while True:
    username = generate_username(random.choice([4, 5]))
    try:
        bot.get_chat(username)
        print(f"{username} → محجوز")
    except telebot.apihelper.ApiTelegramException as e:
        if e.error_code == 400 or "not found" in str(e).lower():
            msg = f"يوزر نادر متاح دلوقتي!!\n{username}\nروح احجزه فوراً من الإعدادات → Username"
            bot.send_message(CHAT_ID, msg)
            print(f"تم إرسال → {username}")
    except Exception as e:
        print("خطأ:", e)
    
    time.sleep(6)  # 6 ثواني بين كل محاولة
